# mhwd Driver Config

NAME="video-nvidia-470xx-prime-render-offload"
INFO="Hybrid prime solution for NVIDIA Optimus Technology - Closed source NVIDIA driver & open source intel&amd driver."
VERSION="2022.01.29"
FREEDRIVER="false"
PRIORITY="17"

# NVIDIA cards
CLASSIDS="0300 0302"
VENDORIDS="10de"
DEVICEIDS=">/var/lib/mhwd/ids/pci/nvidia-470xx.ids"

# Intel OR AMD cards
CLASSIDS="0300"
VENDORIDS="8086 1002"
DEVICEIDS="*"

# Conflicts
CONFLICTS="nvidia-utils opencl-nvidia nvidia-settings"
CONFLICTS_64="lib32-nvidia-utils lib32-opencl-nvidia"
CONKMOD="nvidia-dkms"

# Conflicts with other mhwd configs
MHWDCONFLICTS="video*nvidia*"

# Depends on other mhwd configs
MHWDDEPENDS="video-linux"

# Dependencies
DEPENDS="egl-wayland
         nvidia-prime
         nvidia-470xx-utils
         nvidia-470xx-settings
         libxnvctrl-470xx
         opencl-nvidia-470xx"
DEPENDS_64="lib32-nvidia-470xx-utils lib32-opencl-nvidia-470xx"
DEPKMOD="nvidia-470xx-dkms"

post_install()
{
    mhwd-gpu --setmod nvidia
}

post_remove()
{
    mhwd-gpu --check
}
